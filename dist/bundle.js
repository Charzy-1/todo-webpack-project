(()=>{let e=JSON.parse(localStorage.getItem("tasks"))||[];const t=()=>{localStorage.setItem("tasks",JSON.stringify(e))},n=()=>{e.forEach(((e,t)=>{e.index=t+1}))},a=()=>{const s=document.getElementById("todo-list");s.innerHTML="",e.sort(((e,t)=>e.index-t.index)),e.forEach(((d,i)=>{const r=document.createElement("div");r.classList.add("task-item"),d.completed&&r.classList.add("completed"),r.setAttribute("draggable",!0),r.setAttribute("data-index",i),r.innerHTML=`\n      <input type="checkbox" ${d.completed?"checked":""} data-index="${i}">\n      <span contenteditable="false">${d.description}</span>\n      <div class="menu">\n        <i class="fa-solid fa-ellipsis-v" data-index="${i}"></i>\n        <i class="fa-solid fa-trash" data-index="${i}"></i>\n      </div>\n    `,s.appendChild(r);const c=r.querySelector('input[type="checkbox"]');c.addEventListener("change",(()=>{d.completed=c.checked,t(),a()})),r.querySelector(".fa-trash").addEventListener("click",(()=>{e=e.filter(((e,t)=>t!==i)),n(),t(),a()})),r.querySelector(".fa-ellipsis-v").addEventListener("click",(()=>{r.classList.toggle("show-bin");const e=r.querySelector("span");e.contentEditable=r.classList.contains("show-bin"),"true"===e.contentEditable&&e.focus()}));const l=r.querySelector("span");l.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),l.contentEditable=!1,d.description=l.innerText,t(),a())})),r.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text/plain",i),r.classList.add("dragging")})),r.addEventListener("dragend",(()=>{r.classList.remove("dragging")})),r.addEventListener("dragover",(e=>{e.preventDefault(),r.classList.add("drag-over")})),r.addEventListener("dragleave",(()=>{r.classList.remove("drag-over")})),r.addEventListener("drop",(s=>{s.preventDefault(),r.classList.remove("drag-over");const d=s.dataTransfer.getData("text/plain"),c=i,l=e.splice(d,1)[0];e.splice(c,0,l),n(),t(),a()}))}))};document.getElementById("task-form").addEventListener("submit",(n=>{n.preventDefault();const s=document.getElementById("task-input");""!==s.value.trim()&&((n=>{const s={description:n,completed:!1,index:e.length+1};e.push(s),t(),a()})(s.value),s.value="")})),document.getElementById("clear-completed").addEventListener("click",(()=>{e=e.filter((e=>!e.completed)),n(),t(),a()})),window.onload=()=>{a()}})();